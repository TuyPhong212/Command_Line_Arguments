pipeline {
    agent any
    
    stages {
        stage("Clean Up"){
            steps {
                deleteDir()
            }
        }
        stage('Checkout') {
            steps {
                // Đặt đường dẫn của mã nguồn chương trình C
                sh "git clone https://github.com/cuongmaidt2/Command_Line_Arguments.git"
            }
        }
        
        stage('Build') {
            steps {
                // Thực hiện các lệnh build chương trình C
                sh '''
                cd /var/jenkins_home/workspace/Command_Line_Arguments/Command_Line_Arguments
                gcc -o Command_Line_Arguments Command_Line_Arguments.c
                '''
            }
        }
        
        stage('Test') {
            steps {
                // Thực hiện các lệnh kiểm tra chương trình C
                sh '''
                cd /var/jenkins_home/workspace/Command_Line_Arguments/Command_Line_Arguments
                ./Command_Line_Arguments Argv1 Argv2
                '''
            }
        }

        stage('Push') {
            steps {
                // Thực hiện các push file đã biên dịch lên GIT
                sh '''
                cd /var/jenkins_home/workspace/Command_Line_Arguments/Command_Line_Arguments
                echo $(git remote set-url origin git@github.com:cuongmaidt2/Command_Line_Arguments.git)
                git config --global user.name "cuongmaidt2"
                git config --global user.email "cuongmaidt2@users.noreply.github.com"
                git config --global credential.https://github.com.username cuongmaidt2
                git config --global credential.https://github.com.token ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDMDi9y1HpWs7JY3j4fGlREcj4kCxMrGscmFXglpZjGqp2276D1e65TeufjTg1y+fp1QDFVtoHRpYXWktreLh/uTeFL5anAaBQpFxv7+20Y+HAsYabSODEnEcy32BzPHAY9LrwoDuLlmOEwyxRxzxgk91JpT6Owan9GN8slefEuew== noname
                git add Command_Line_Arguments
                git commit -m Command_Line_Arguments
                git push -u origin main
                '''
            }
        }
    }
}
